{% extends 'base.html' %}
{% load static %}

{% block title %}An치lisis SEO - SmoothlySEO{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="d-flex justify-content-end mb-3">
        <button id="history-button" class="btn btn-outline-secondary">Historial</button>
    </div>
    <h1 class="text-center mb-4 text-primary">An치lisis WEB</h1>

    {% if error %}
        <div class="alert alert-danger d-flex align-items-center justify-content-between alert-dismissible fade show" role="alert">
            <div>
                <i class="bi bi-exclamation-triangle me-2"></i>
                <span>{{ error }}</span>
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    {% endif %}

    <div class="card mb-5 shadow-sm border-0 rounded-3">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">Analizar tu Sitio Web</h4>
        </div>
        <div class="card-body p-4">
            <form method="post" id="analysis-form" class="needs-validation" novalidate>
                {% csrf_token %}
                <div class="mb-3">
                    <label for="{{ form.url.id_for_label }}" class="form-label">{{ form.url.label }}</label>
                    <input type="text" name="url" class="form-control" id="{{ form.url.id_for_label }}" value="{{ form.url.value|default:'' }}" placeholder="Ejemplo: as.com o https://as.com" required>
                    {% if form.url.errors %}
                        <div class="invalid-feedback">
                            {{ form.url.errors }}
                        </div>
                    {% endif %}
                </div>
                <button type="submit" class="btn btn-primary btn-lg w-100" id="analyze-button">Analizar</button>
            </form>
        </div>
    </div>
</div>

<!-- Overlay de carga con GIF -->
<div id="loadingOverlay" class="loading-overlay" style="display: none;">
    <img src="{% static 'images/gif-carga.gif' %}" alt="Cargando..." class="loading-gif">
    <p class="mt-3 fs-5">Procesando an치lisis, por favor espera...</p>
</div>

<!-- Modal para el historial -->
<div id="historyModal" class="modal" style="display: none;">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Historial de An치lisis</h5>
                <button type="button" id="closeModal" class="btn-close" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <ul id="historyList" class="list-group"></ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{% static 'js/overview.js' %}"></script>
{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/overview.css' %}">
{% endblock %}
